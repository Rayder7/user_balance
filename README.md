# Опиание ТЗ.
ТЗ:
1.Разработать API для работы со балансом пользователя и перемещении денег между пользователями системы
У каждого пользователя есть свой баланс, изначально он равен 0.
2.Разработать API, который принимает число (количество копеек) и увеличивает баланс залогиненного пользователя на данное число. Абстрагируемся от реально оплаты и денег, реализуя лишь последний шаг зачисления денег на  баланс. Он может пополнить свой баланс в любой момент времени.
3.Разработать API, который производит списание с текущего баланса пользователя на баланс другого пользователя по user_id по требованию (перевод денег). Только залогиненный пользователь может производить списания со своего баланса, но начисления возможны без каких-либо подтверждений со  стороны получателя.
4.Разработать API, который возвращает текущий баланс залогиненого пользователя в рублях.

Дополнительные требования:
5.вести учет транзакций по операциям пополнения баланса
6.вести учет транзакций по операциям переводов между пользователями
7.запрещать переводы, если сумма перевода  для  инициатора превышает его  текущий баланс
8.предусмотреть случаи одновременного пополнения и списания денег в рамках одного пользователя (мне прислали 100 рублей и одновременно в ту же секунду/долю  секунды я положил 1 рубль- баланс должен быть 101, а не 100  или  1).

## Инструкции по установке
***- Клонируйте репозиторий:***
```
git clone git@github.com:rayder7/user_balance.git
```

***- Установите и активируйте виртуальное окружение:***
```
- для Windows
```
python -m venv venv
source venv/bin/activate
source venv/Scripts/activate
```
 
***- Установите зависимости из файла requirements.txt:***
```
pip install -r requirements.txt
```

***- Примените миграции:***
```
python manage.py migrate
```

***- В папке с файлом manage.py выполните команду для запуска локально:***
```
python manage.py runserver
```

### Собираем контейнерыы:

Из папки infra/ разверните контейнеры при помощи docker-compose:
```
docker-compose up -d --build
```
Выполните миграции:
```
docker-compose exec backend python manage.py migrate
```
Создайте суперпользователя:
```
winpty docker-compose exec backend python manage.py createsuperuser
```
Соберите статику:
```
docker-compose exec backend python manage.py collectstatic --no-input
```
Наполните базу данных ингредиентами и тегами. Выполняйте команду из дериктории где находится файл manage.py:
```
docker-compose exec backend python manage.py load_data

```
Остановка проекта:
```
docker-compose down
```

### Подготовка к запуску проекта на удаленном сервере

Cоздать и заполнить .env файл в директории infra
```
DB_ENGINE=django.db.backends.postgresql
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432
```
